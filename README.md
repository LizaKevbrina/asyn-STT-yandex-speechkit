<div align="center">

#  STT Microservice

**–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ –¥–ª—è AI-–∞–≥–µ–Ω—Ç–æ–≤: –æ—Ç –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–æ —Ç–µ–∫—Å—Ç–∞ –∑–∞ 60 —Å–µ–∫—É–Ω–¥**

[![FastAPI](https://img.shields.io/badge/FastAPI-009688?style=for-the-badge&logo=fastapi&logoColor=white)](https://fastapi.tiangolo.com)
[![Yandex Cloud](https://img.shields.io/badge/Yandex_Cloud-FF0000?style=for-the-badge&logo=yandex&logoColor=white)](https://cloud.yandex.ru)
[![Docker](https://img.shields.io/badge/Docker-2496ED?style=for-the-badge&logo=docker&logoColor=white)](https://www.docker.com)
[![Production Ready](https://img.shields.io/badge/production-ready-success?style=for-the-badge)](https://github.com/LizaKevbrina/stt-microservice)

*–û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ –¥–æ 4 —á–∞—Å–æ–≤ ‚Ä¢ –ê–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–æ–≤ ‚Ä¢ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ*

[ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç) ‚Ä¢ [ Use Cases](#-–∫–æ–º—É-—ç—Ç–æ-–Ω—É–∂–Ω–æ) ‚Ä¢ [ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è](#-–∫–∞–∫-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å)

</div>

---

##  –ü—Ä–æ–±–ª–µ–º–∞

–ì–æ–ª–æ—Å–æ–≤—ã–µ –∫–∞–Ω–∞–ª—ã –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ —Ç–µ—Ä—è—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏–∑-–∑–∞:

-  **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª–∏–Ω–Ω—ã—Ö –∞—É–¥–∏–æ** ‚Äî –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ API –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã 30 —Å–µ–∫—É–Ω–¥–∞–º–∏
-  **–†–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∞—É–¥–∏–æ** ‚Äî MP3, OGG, WAV —Ç—Ä–µ–±—É—é—Ç —Ä—É—á–Ω–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
-  **–ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∂–¥–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç
-  **–î–æ—Ä–æ–≥–∏–µ —Ä–µ—à–µ–Ω–∏—è** ‚Äî enterprise STT —Å–µ—Ä–≤–∏—Å—ã –æ—Ç $0.02/–º–∏–Ω—É—Ç–∞

---

##  –†–µ—à–µ–Ω–∏–µ

Production-ready –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π **–ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≥–æ–ª–æ—Å –≤ —Ç–µ–∫—Å—Ç** –¥–ª—è –ª—é–±—ã—Ö AI-—Å–∏—Å—Ç–µ–º:

```
 –ê—É–¥–∏–æ—Å–æ–æ–±—â–µ–Ω–∏–µ (–¥–æ 4 —á–∞—Å–æ–≤) ‚Üí  –ê–≤—Ç–æ–æ–±—Ä–∞–±–æ—Ç–∫–∞ ‚Üí  –†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –∑–∞ 60 —Å–µ–∫
```

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

| –®–∞–≥ | –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|-----|----------------|-----------|
| 1Ô∏è‚É£ –ó–∞–≥—Ä—É–∑–∫–∞ | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∞—É–¥–∏–æ —á–µ—Ä–µ–∑ API | –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ |
| 2Ô∏è‚É£ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è | MP3 ‚Üí OGG (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ) | –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è STT |
| 3Ô∏è‚É£ –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ | Yandex SpeechKit –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –¥–æ 4 —á–∞—Å–æ–≤ –∞—É–¥–∏–æ |
| 4Ô∏è‚É£ –†–µ–∑—É–ª—å—Ç–∞—Ç | –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ polling | 95%+ —Ç–æ—á–Ω–æ—Å—Ç—å |

---

##  –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

<table>
<tr>
<td align="center" width="25%">
<h3>60 —Å–µ–∫</h3>
<p>–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏</p>
</td>
<td align="center" width="25%">
<h3>4 —á–∞—Å–∞</h3>
<p>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –∞—É–¥–∏–æ</p>
</td>
<td align="center" width="25%">
<h3>95%+</h3>
<p>–¢–æ—á–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è</p>
</td>
<td align="center" width="25%">
<h3>MP3/OGG</h3>
<p>–ê–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–æ–≤</p>
</td>
</tr>
</table>

### –ë–∏–∑–Ω–µ—Å-—ç—Ñ—Ñ–µ–∫—Ç

- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª–∏–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π** ‚Äî –≤—Å—Ç—Ä–µ—á–∏, –ø–æ–¥–∫–∞—Å—Ç—ã, –ª–µ–∫—Ü–∏–∏ –¥–æ 4 —á–∞—Å–æ–≤
- ‚úÖ **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å** ‚Äî –ª—é–±–æ–π —Ñ–æ—Ä–º–∞—Ç –∞—É–¥–∏–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Ç–µ–Ω –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- ‚úÖ **–ù–∏–∑–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å** ‚Äî –≤ 10 —Ä–∞–∑ –¥–µ—à–µ–≤–ª–µ enterprise —Ä–µ—à–µ–Ω–∏–π

---

##  –ö–æ–º—É —ç—Ç–æ –Ω—É–∂–Ω–æ

<table>
<tr>
<td width="33%" valign="top">

###  Call-—Ü–µ–Ω—Ç—Ä—ã
**–ü—Ä–æ–±–ª–µ–º–∞:** 1000+ –∑–≤–æ–Ω–∫–æ–≤/–¥–µ–Ω—å, –≤—Ä—É—á–Ω—É—é –Ω–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å

**–†–µ—à–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –æ–±—É—á–µ–Ω–∏—è

</td>
<td width="33%" valign="top">

###  EdTech
**–ü—Ä–æ–±–ª–µ–º–∞:** –õ–µ–∫—Ü–∏–∏ –∏ –≤–µ–±–∏–Ω–∞—Ä—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –≤–∏–¥–µ

**–†–µ—à–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—É–±—Ç–∏—Ç—Ä—ã –∏ –ø–æ–∏—Å–∫ –ø–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É

</td>
<td width="33%" valign="top">

###  –ú–µ–¥–∏–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–¥–∫–∞—Å—Ç—ã/–∏–Ω—Ç–µ—Ä–≤—å—é —Ç—Ä–µ–±—É—é—Ç –¥–æ—Ä–æ–≥–æ–π —Ä—É—á–Ω–æ–π —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏

**–†–µ—à–µ–Ω–∏–µ:** –ê–≤—Ç–æ—Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è —Å –º–µ—Ç–∫–∞–º–∏ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

</td>
</tr>
</table>

---

##  –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ö–∞–∫ —á–∞—Å—Ç—å AI Sales Agent (–≥–ª–∞–≤–Ω—ã–π –ø—Ä–æ–µ–∫—Ç)

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ [ AI Sales Agent](https://github.com/LizaKevbrina/ai-agent-microservices) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤.

**Workflow:** Telegram –≥–æ–ª–æ—Å–æ–≤–æ–µ ‚Üí STT ‚Üí LLM ‚Üí RAG ‚Üí –û—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É

```bash
# –£–∂–µ –≤–∫–ª—é—á–µ–Ω –≤ –≥–ª–∞–≤–Ω—ã–π –ø—Ä–æ–µ–∫—Ç
cd ai-agent-microservices
make start  # STT —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: Standalone ‚Äî –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞–∫ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –ª—é–±–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞, —Ç—Ä–µ–±—É—é—â–µ–≥–æ STT:

**–®–∞–≥ 1:** –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
```bash
git clone https://github.com/LizaKevbrina/stt-microservice.git
cd stt-microservice
```

**–®–∞–≥ 2:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `.env`
```bash
cp .env.example .env
nano .env  # –î–æ–±–∞–≤—å—Ç–µ YANDEX_API_KEY, S3 credentials
```

**–®–∞–≥ 3:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ
```bash
docker-compose up -d
```

**–®–∞–≥ 4:** –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∞—É–¥–∏–æ
```bash
curl -X POST http://localhost:8000/api/v1/stt/transcribe \
  -F "audio_file=@voice.mp3" \
  -F "user_id=test" \
  -F "lang=ru-RU"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "operation_id": "e03s6k9mj6qh********",
  "check_status_url": "/api/v1/stt/status/e03s6k9mj6qh********"
}
```

**–®–∞–≥ 5:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
```bash
curl http://localhost:8000/api/v1/stt/status/e03s6k9mj6qh********
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "done": true,
  "text": "–î–æ–±—Ä—ã–π –¥–µ–Ω—å –º–µ–Ω—è –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç –∫–≤–∞—Ä—Ç–∏—Ä—ã –≤ –Ω–æ–≤–æ—Å—Ç—Ä–æ–π–∫–µ...",
  "chunks_count": 15
}
```

---

##  –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

<table>
<tr>
<td width="50%">

###  –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ –∞—É–¥–∏–æ (MP3/OGG)
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è MP3 ‚Üí OGG (Opus)
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª–∏–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- Retry-–ª–æ–≥–∏–∫–∞ –ø—Ä–∏ —Å–±–æ—è—Ö

</td>
<td width="50%">

###  Production-ready
- Health checks –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- Metrics API –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è `/docs`

</td>
</tr>
</table>

---

##  –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Å—Ö–µ–º–∞

```mermaid
flowchart LR
    A[ Audio Input] -->|POST /transcribe| B[ Format Detection]
    B -->|MP3| C[ Convert to OGG]
    B -->|OGG| D[ Upload to S3]
    C --> D
    D --> E[ Yandex SpeechKit]
    E -->|operation_id| F[ Polling]
    F -->|GET /status| G[ Transcribed Text]
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è |
|-----------|-----------|------------|
| **FastAPI Service** | REST API –¥–ª—è STT | Python 3.11, FastAPI |
| **Audio Processing** | –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–æ–≤ | pydub, ffmpeg |
| **Object Storage** | –•—Ä–∞–Ω–µ–Ω–∏–µ –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤ | S3-compatible (Yandex Cloud) |
| **STT Engine** | –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ | Yandex SpeechKit API |

<details>
<summary><b> –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)</b></summary>

### API Endpoints

| Endpoint | Method | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|--------|----------|
| `/api/v1/stt/transcribe` | POST | –ó–∞–≥—Ä—É–∑–∫–∞ –∞—É–¥–∏–æ, —Å—Ç–∞—Ä—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è |
| `/api/v1/stt/status/{id}` | GET | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ |
| `/api/v1/metrics` | GET | –ú–µ—Ç—Ä–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã (–∑–∞–ø—Ä–æ—Å—ã, –æ—à–∏–±–∫–∏, –≤—Ä–µ–º—è) |
| `/api/v1/health` | GET | Health check |
| `/docs` | GET | Swagger UI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤

```python
# –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ –ø–æ magic bytes
if audio_data.startswith(b'ID3'):
    format = "MP3"
elif audio_data.startswith(b'OggS'):
    format = "OGG_OPUS"

# –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è MP3 ‚Üí OGG (Opus)
audio = AudioSegment.from_file(BytesIO(audio_data), format="mp3")
audio = audio.set_channels(1)  # Mono
audio.export(ogg_buffer, format="ogg", codec="libopus")
```

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π workflow

1. **Upload** ‚Äî –∞—É–¥–∏–æ –≤ S3 (KMS encryption)
2. **Submit** ‚Äî –∑–∞–ø—Ä–æ—Å –≤ Yandex STT API
3. **Poll** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
4. **Result** ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ chunks

### Retry pattern

- –î–æ 20 –ø–æ–ø—ã—Ç–æ–∫ —Å exponential backoff
- Timeout: 30 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–ø—Ä–æ—Å
- Graceful degradation –ø—Ä–∏ —Å–±–æ—è—Ö

</details>

---

##  –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ó–∞ 3 –º–∏–Ω—É—Ç—ã

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–µ–º
git clone https://github.com/LizaKevbrina/stt-microservice.git
cd stt-microservice

# 2. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å–µ–∫—Ä–µ—Ç—ã
cp .env.example .env
# –ó–∞–ø–æ–ª–Ω–∏—Ç–µ: YANDEX_API_KEY, S3_BUCKET_NAME, AWS_ACCESS_KEY_ID

# 3. –ó–∞–ø—É—Å–∫–∞–µ–º
docker-compose up -d

# 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º
curl http://localhost:8000/api/v1/health
```

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- Docker & Docker Compose
- 2GB RAM, 1 vCPU
- API –∫–ª—é—á–∏: Yandex Cloud, S3-compatible storage

---

##  –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

**Backend:** FastAPI (Python 3.11), httpx, pydantic  
**Audio:** pydub, ffmpeg  
**Storage:** boto3 (S3-compatible)  
**AI:** Yandex SpeechKit (async STT)  
**Infrastructure:** Docker

<details>
<summary><b> –ß—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ–µ–∫—Ç (–¥–ª—è —Ç–µ—Ö–ª–∏–¥–æ–≤)</b></summary>

### Backend Engineering
‚úÖ RESTful API —Å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º  
‚úÖ Async/await –¥–ª—è non-blocking I/O  
‚úÖ Multipart form-data handling  
‚úÖ Background tasks (FastAPI BackgroundTasks)  
‚úÖ Structured logging  
‚úÖ Error handling & retry patterns

### Infrastructure
‚úÖ Docker containerization  
‚úÖ S3 integration (boto3)  
‚úÖ Health checks & metrics  
‚úÖ Production-ready deployment  
‚úÖ Secrets management (.env)

### Audio Processing
‚úÖ Format detection (magic bytes)  
‚úÖ MP3 ‚Üí OGG conversion (pydub)  
‚úÖ Streaming file upload  
‚úÖ Large file handling (up to 4 hours)

### External API Integration
‚úÖ Yandex SpeechKit async API  
‚úÖ Long-polling pattern  
‚úÖ Operation status tracking  
‚úÖ Timeout & retry logic

</details>

---

##  –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| **–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏** | 30-90 —Å–µ–∫ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–ª–∏–Ω—ã –∞—É–¥–∏–æ) |
| **–ú–∞–∫—Å. –¥–ª–∏–Ω–∞ –∞—É–¥–∏–æ** | 4 —á–∞—Å–∞ |
| **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã** | MP3, OGG, WAV (–∞–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è) |
| **–¢–æ—á–Ω–æ—Å—Ç—å** | 95%+ (—Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫) |
| **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** | –¥–æ 10 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ |
| **–°—Ç–æ–∏–º–æ—Å—Ç—å** | ~$0.002/–º–∏–Ω—É—Ç–∞ (Yandex Cloud) |

---

##  –ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –ü—Ä–∏–º–µ—Ä 1: Telegram –±–æ—Ç

```python
from telegram import Update
from telegram.ext import MessageHandler, filters
import httpx

async def handle_voice(update: Update, context):
    # –°–∫–∞—á–∏–≤–∞–µ–º –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    voice = await update.message.voice.get_file()
    voice_bytes = await voice.download_as_bytearray()
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ STT —Å–µ—Ä–≤–∏—Å
    async with httpx.AsyncClient() as client:
        response = await client.post(
            "http://stt-service:8000/api/v1/stt/transcribe",
            files={"audio_file": voice_bytes},
            data={"user_id": str(update.message.from_user.id)}
        )
    
    operation_id = response.json()["operation_id"]
    await update.message.reply_text("–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –∞—É–¥–∏–æ...")
    
    # Polling —Å—Ç–∞—Ç—É—Å–∞
    while True:
        status = await client.get(f"http://stt-service:8000/api/v1/stt/status/{operation_id}")
        data = status.json()
        if data["done"]:
            await update.message.reply_text(f"–¢–µ–∫—Å—Ç: {data['text']}")
            break
        await asyncio.sleep(5)
```

### –ü—Ä–∏–º–µ—Ä 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π FastAPI –ø—Ä–æ–µ–∫—Ç

```python
# –í–∞—à main.py
from fastapi import FastAPI, UploadFile
import httpx

app = FastAPI()

@app.post("/process-audio")
async def process_audio(audio: UploadFile):
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ STT –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å
    async with httpx.AsyncClient() as client:
        response = await client.post(
            "http://stt-service:8000/api/v1/stt/transcribe",
            files={"audio_file": await audio.read()},
            data={"user_id": "app_user"}
        )
    
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    return response.json()
```

### –ü—Ä–∏–º–µ—Ä 3: n8n workflow

```json
{
  "nodes": [
    {
      "name": "HTTP Request - STT",
      "type": "n8n-nodes-base.httpRequest",
      "parameters": {
        "url": "http://stt-service:8000/api/v1/stt/transcribe",
        "method": "POST",
        "bodyParameters": {
          "parameters": [
            {"name": "audio_file", "value": "={{$binary.data}}"},
            {"name": "user_id", "value": "={{$json.userId}}"}
          ]
        }
      }
    }
  ]
}
```

---

##  –≠–∫–æ—Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤

–≠—Ç–æ—Ç –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å ‚Äî **–º–æ–¥—É–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç**, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ –∏–ª–∏ –∫–∞–∫ —á–∞—Å—Ç—å AI-–∞–≥–µ–Ω—Ç–∞:

| –ü—Ä–æ–µ–∫—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –°–≤—è–∑—å |
|--------|----------|-------|
| **[ AI Sales Agent](https://github.com/LizaKevbrina/ai-agent-microservices)** | –ì–ª–∞–≤–Ω—ã–π –ø—Ä–æ–µ–∫—Ç ‚Äî –≥–æ–ª–æ—Å–æ–≤–æ–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è –ø—Ä–æ–¥–∞–∂ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç STT –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π |
| **STT Microservice** (—ç—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π) | –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ –¥–æ 4 —á–∞—Å–æ–≤ | Standalone –º–æ–¥—É–ª—å –¥–ª—è –ª—é–±—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ |
| **[ RAG Knowledge Sync](https://github.com/LizaKevbrina/rag-knowledge-sync)** | –ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –≥–ª–∞–≤–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ |

---

##  Part of AI Agent Platform

–≠—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã [ AI Sales Agent](https://github.com/LizaKevbrina/ai-agent-microservices) ‚Äî production-ready AI-–∞–≥–µ–Ω—Ç–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–¥–∞–∂ –≤ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏.

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –≥–ª–∞–≤–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ

**Workflow:** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram ‚Üí n8n workflow ‚Üí **STT Microservice** —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —Ä–µ—á—å ‚Üí LLM –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç ‚Üí RAG –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π ‚Üí –û—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
```yaml
# docker-compose.yml –≥–ª–∞–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
services:
  stt-service:
    image: ghcr.io/lizakevbrina/stt-microservice:latest
    environment:
      - YANDEX_API_KEY=${YANDEX_API_KEY}
    ports:
      - "8002:8000"
```

### Standalone –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å STT Microservice **–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ** –¥–ª—è:
-  –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏ call-—Ü–µ–Ω—Ç—Ä–æ–≤
-  –û–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ–¥–∫–∞—Å—Ç–æ–≤ –∏ –∏–Ω—Ç–µ—Ä–≤—å—é
-  –°–æ–∑–¥–∞–Ω–∏—è —Å—É–±—Ç–∏—Ç—Ä–æ–≤ –¥–ª—è EdTech –ø–ª–∞—Ç—Ñ–æ—Ä–º
-  –õ—é–±—ã—Ö AI-–∞–≥–µ–Ω—Ç–æ–≤, —Ç—Ä–µ–±—É—é—â–∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫—É –≥–æ–ª–æ—Å–∞

**–°–º. —Ç–∞–∫–∂–µ:**
- [ RAG Knowledge Sync](https://github.com/LizaKevbrina/rag-knowledge-sync) ‚Äî –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
- [ AI Sales Agent](https://github.com/LizaKevbrina/ai-agent-microservices) ‚Äî –≥–ª–∞–≤–Ω—ã–π –ø—Ä–æ–µ–∫—Ç

---

##  –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License ‚Äî —Å–º. [LICENSE](LICENSE)

---

<div align="center">

## üë©‚Äçüíª –ê–≤—Ç–æ—Ä

**–ï–ª–∏–∑–∞–≤–µ—Ç–∞ –ö–µ–≤–±—Ä–∏–Ω–∞**

*LLM Engineer ‚Ä¢ Workflow Automation ‚Ä¢ AI Integrations*

[![Email](https://img.shields.io/badge/Email-elisa.kevbrina%40yandex.ru-red?style=flat-square&logo=gmail)](mailto:elisa.kevbrina@yandex.ru)
[![GitHub](https://img.shields.io/badge/GitHub-%40LizaKevbrina-black?style=flat-square&logo=github)](https://github.com/LizaKevbrina)

---

**‚≠ê –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –ø–æ–ª–µ–∑–µ–Ω, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É!**

*Made with ‚ù§Ô∏è for AI community*

</div>
